# Changelog

All notable changes to this project will be documented in this file.

The format is based on [Keep a Changelog](https://keepachangelog.com/en/1.0.0/),
and this project adheres to [Semantic Versioning](https://semver.org/spec/v2.0.0.html).

## [Unreleased]

### Добавлено

- Добавлена новая зависимость: `tinylogging`

### Изменено

- Каталог `bot` был переименован в `handlers`
- Файл `handlers.py` был переименован в `message.py`

## [8.0.0] - 2024-09-08

### Добавлено

- Добавлены правила. Каждый игрок обязан прочитать правила и согласится с ними чтобы продолжить использовать бота
- Новые поля в модели пользователя
- Добавлены команды для модераторов [#38](https://github.com/HamletSargsyan/livebot/issues/38)

### Изменено

- Мобы теперь встретиться только спустя 15–20 минут с начала прогулки

## [7.1.0] - 2024-08-31

### Добавлено

- Кнопка с ссылкой на гайд в обменнике
- Время через сколько появится новый предмет в обменнике

## [7.0.0] - 2024-08-30

### Изменено

- Модели базы данных изменены на `dataclass`

### Исправлено

- Якорные ссылки в документации

## [6.0.0] - 2024-08-28

### Добавлено

- Добавлен скрипт `tools/create_config.py` для генерации конфига бота
- Новые страницы в документации для разработчиков
- Логирование исключений которые возникают в `telebot` с использованием класса `ExceptionHandler`.

### Изменено

- Функции действий для игрока (прогулка, работа, и тд) из `base/player.py` перенесены в `base/actions.py`
- Рефакторинг файла `config.py`. Теперь все конфиги хранятся в файле `config.toml` в место файла `.env`
- Модуль `requests` окончательно заменен на `httpx`
- В команде `/event` теперь отображается сколько осталось до начала ивента

### Удалено

- Библиотека `python-dotenv` из файла `requirements.txt`

## [5.1.0] - 2024-08-16

### Добавлено

- Новые достижения

### Исправлено

- Орфографическая ошибка в имени предмета `клевер-удачи`

## [5.0.0] - 2024-08-16

### Добавлено

- Команда `/time`
- Кеширование в команду `/weather`. Погода обновляется раз в 30 минут
- Достижения (команда `/achievements`)

### Изменено

- Модуль `requests` заменен на `httpx`

### Исправлено

- Орфографические ошибки в документации

## [4.2.0] - 2024-08-08

### Исправлено

- Типизация для новой версии `pyTelegramBotApi`

## [4.1.0] - 2024-08-06

### Изменено

- Уменьшено кол-во предметов которые могут попасться в сундуке
- Изменен редкость некоторых предметов

## [4.0.1] - 2024-07-31

### Изменено

- Рефакторинг функции `use_item`
- Уменьшен шас встречи сундука во время прогулки

### Исправлено

- Баг-фикс ([коммит](https://github.com/HamletSargsyan/livebot/commit/58f8ca0b957ef9485896722eb4e7b96c52bae589))

## [4.0.0] - 2024-07-26

### Добавлено

- Процент использования для предметов ([#6](https://github.com/HamletSargsyan/livebot/issues/6))
- Возможность передать приметы с процентами другим игрокам ([#41](https://github.com/HamletSargsyan/livebot/issues/41))

### Изменено

- В команде `/market` теперь отображаются сначала новые предметы ([#40](https://github.com/HamletSargsyan/livebot/issues/40))
- Изменен шанс встречи мобов
- Подсказка о том как использовать команду `/transfer`
- В команде `/shop` сначала отображаются дорогие предметы

## [3.9.0] - 2024-07-24

### Изменено

- Подсказка о том как использовать команды `/casino` и `/shop`

### Удалено

- Все что связанно с интеграций с сервисом GramAds, которые была помечена как устаревшая в версии `3.6.3`

## [3.8.0] - 2024-07-24

### Добавлено

- Добавлена команда `/version` ([#37](https://github.com/HamletSargsyan/livebot/issues/37))

### Изменено

- Максимальное кол-во опыта в бусте была уменьшена с 500 до 150, из-за изменения механики получения нового уровня в версии `3.3.0`

## [3.7.0] - 2024-07-23

### Изменено

- Подсказка о том как использовать команду `/craft`

### Исправлено

- Ошибки с сравнением времени

### Удалено

- Кеширование, из-за изменения результата функции ([#35](https://github.com/HamletSargsyan/livebot/issues/35), [#34](https://github.com/HamletSargsyan/livebot/issues/34), [#33](https://github.com/HamletSargsyan/livebot/issues/33))

## [3.6.4] - 2024-07-22

### Исправлено

- Орфографические ошибки в документации

## [3.6.3] - 2024-07-22

### Устарело

- Все что связанно с интеграций с сервисом GramAds

### Добавлено

- Кеширование некоторых функций, для увеличения скорости работы с ботом

## [3.6.2] - 2024-07-10

### Удалено

- Уведомления о новых постах на канале

## [3.6.1] - 2024-07-10

### Исправлено

- Баг с отправкой уведомлений релизов в канал

## [3.6.0] - 2024-07-10

### Удалено

- Функция `reload_modules()` из файла `main.py`
- Переменная `GUIDE_FILE_PATH` из файла `config.py`

### Добавлено

- Переменная `version` в файле `config.py`
- Отображение версии бота в команде `/help`

## [3.5.1] - 2024-07-03

### Добавлено

- Новое поле к модели `UserModel`: `last_active_time`

### Исправлено

- Баг с обменником ([#18](https://github.com/HamletSargsyan/livebot/issues/18))
- Орфографические ошибки

## [3.5.0] - 2024-06-09

### Добавлено

- Добавлена новая библиотека: `argparse`
- Добавлена команда `/daily_gift` ([#20](https://github.com/HamletSargsyan/livebot/issues/20))
- Добавлена интеграция с сервисом GramAds ([#23](https://github.com/HamletSargsyan/livebot/issues/23))

### Изменено

- Рефакторинг главного файла (`main.py`)
- Изменен процесс обновления опыта и уровня собак

## [3.4.1] - 2024-06-06

### Добавлено

- Добавлен аргумент `--without-threads`, чтобы запускать бота без потоков (нужен для отладки)
- Конвертация типов в ожидаемое типы (если это возможно) в классе `BaseModel`

## [3.4.0] - 2024-06-06

### Изменено

- Ограничена длинна имени в топах

### Добавлено

- Класс `Field` для удобной работы с моделями

### Исправлено

- Баг [#19](https://github.com/HamletSargsyan/livebot/issues/19)

## [3.3.1] - 2024-06-05

### Исправлено

- Исправил баг в команде `/top` из за которого показывалось больше строчек чем надо

## [3.3.0] - 2024-06-05

### Изменено

- Изменена редкость предмета "ключ" с `ItemRarity.UNCOMMON` на `ItemRarity.RARE`
- Увеличен шанс встречи для моба `сундук` с 3.2 до 8.2
- Изменен расчет вероятности увеличения количества предметов в функции `street`
- Изменен процесс обновления опыта и уровня пользователя
- В функциях `coin_top`, `level_top` и `dog_level_top` изменен механизм формирования топов на более обобщенный, используя функцию `get_top`, что упрощает поддержку и расширение кода.
- В главном меню пункт `рейтинг` переименован на `топ`
- Команда `/exchanger` не временно отключена из из-за бага [#18](https://github.com/HamletSargsyan/livebot/issues/18)

### Исправлено

- исправлена ​​проблема с отступами в функции promo в `handlers.py`, чтобы обеспечить правильное добавление пользователей промо в список и обновление в базе данных.
- Исправлены орфографические ошибки

### Добавлено

- Добавлена функция `calc_xp_for_level` для расчета необходимого опыта на уровень
- Внедрены дополнительные проверки на наличие уведомлений перед их обновлением
- В команде `/profile` теперь отображается удача

## [3.2.6] - 2024-06-05

### Исправлено

- Баг [#17](https://github.com/HamletSargsyan/livebot/issues/17)

## [3.2.5] - 2024-06-05

### Добавлено

- Эмодзи для типов погоды в команде `/weather` [#7](https://github.com/HamletSargsyan/livebot/issues/7)

### Удалено

- Все что связанно с старым гайдом [#10](https://github.com/HamletSargsyan/livebot/issues/10)
- Иконки в команде `/weather`

## [3.2.4] - 2024-06-01

### Добавлено

- Новый предмет: клевер-удачи 🍀 [#8](https://github.com/HamletSargsyan/livebot/issues/8)

## [3.2.3] - 2024-05-14

### Изменено

- Исправлен баг из за которого при повышении уровня на добавлялся бокс

## [3.2.2] - 2024-05-13

### Изменено

- Умешено кол-во усталости для собаки во время прогулки

### Добавлено

- Добавлен аргумент `--debug` для запуска бота
- Новый атрибут для класса `UserModel`: `luck` (удача)
- При повышении уровня, в сообщении добавлены кнопки для увелечения характеристик игрока

## [3.2.1] - 2024-05-12

### Добавлено

- Команда `/market` в меню команд

### Исправлено

- Исправлены орфографические ошибки
- Исправлен баг из за которого прайс для предметов который отсутствовали на рынке и/или у них не было своего прайса, возникала ошибка
- Исправлен баг при открытии сундука: приметы не сохранялись

## [3.2.0] - 2024-05-12

### Добавлено

- Добавлен лимит на продажу предметов на рынке
- Добавлена возможность отменить продажу предмета

### Изменено

- На рынке сначала отображаются новые товары
- Теперь в команде `/price` и во время продажи предмета и при покупке в рынке отображается его средний прайс за 1 штуку

### Исправлено

- Исправлен баг: когда в рынке пользователь нажимает на кнопку для перехода на следующею страницу, бот не предупреждал об этом и продолжал листать

## [3.1.0] - 2024-05-12

### Исправлено

- Исправлен баг при покупке предметов из рынка

## [3.0.0] - 2024-05-12

### Добавлено

- Рынок (команда `/market`)
- Добавлен redis для хранения стейтов (состояний) и для кеша

## [2.3.1] - 2024-05-10

### Исправлено

- Окончательно исправлен баг [#2](https://github.com/HamletSargsyan/livebot/issues/2)

## [2.3.0] - 2024-05-10

### Добавлено

- Теперь все релизы из github будут автоматический публиковаться в телеграм канал бота
- Добавлена темная тема на сайте

### Исправлено

- Исправлен баг [#2](https://github.com/HamletSargsyan/livebot/issues/2)

## [2.2.1] - 2024-05-10

### Исправлено

- Исправлен баг [#1](https://github.com/HamletSargsyan/livebot/issues/1)

## [2.2.0] - 2024-05-09

### Добавлено

- Добавлен сайт для проекта

### Изменено

- Изменена команда `/guide`. Теперь в место кнопок с документацией, там только одна кнопка которая открывает документацию на сайте (в webapp)

## [2.1.0] - 2024-05-09

### Исправлено

- Метод у класса `logging.Logger` `success` был изменен на `info`, так как его не существует

## [2.0.0] - 2024-05-09

### Изменено

- Изменена структура проекта
